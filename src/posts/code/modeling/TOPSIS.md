---
title: TOPSIS模型
date: 2024-03-03
icon: circle-info
order: 3
---

评价方法大体上可分为两类，其主要区别在确定权重的方法上。一类是主观赋权法，多数采取综合咨询评分确定权重，如综合指数法、模糊综合评判法、层次分析法、功效系数法等。另一类是客观赋权，根据各指标间相关关系或各指标值变异程度来确定权数，如主成分分析法、因子分析法、理想解法（也称TOPSIS法）等。

目前国内外综合评价方法有数十种之多,其中主要使用的评价方法有主成分分析法、因子分析、TOPSIS、秩和比法、灰色关联法、嫡权法、层次分析法、模糊评价法、物元分析法、聚类分析法、价值工程法、神经网络法等。

## TOPSIS解法

目前已有许多解决多属性决策的排序法，如理想点法、简单线性加权法、加权平方和法、主成分分析法、功效系数法、可能满意度法、交叉增援矩阵法等。本节介绍多属性决策问题的理想解法，理想解法亦称为TOPSIS法，是一种有效的多指标评价方法。这种方法通过构造评价问题的正理想解和负理想解，即各指标的最优解和最劣解，通过计算每个方案到理想方案的相对贴近度，即靠近正理想解和远离负理想解的程度，来对方案进行排序，从而选出最优方案。

## 方法和原理

设多属性决策方案集为$D={d_1,d_2,\cdots,d_m}$，衡量方案优劣的属性变量为$x_1,\cdots,x_n$，这时方案集中的每个方案$d_i(i=1,\cdots,m)$的$n$个属性值构成的向量是$[a_{i1},\cdots,a_{in}]$，它作为$n$维空间中的一个点，能唯一的表征方案$d_i$

正理想解$C^*$是一个方案集$D$中并不存在的虚拟的最佳方案,它的每个属性值都是决策矩阵中该属性的最好值;而负理想解$C^0$则是虚拟的最差方案，它的每个属性值都是决策矩阵中该属性的最差值。在$n$维空间中,将方案集$D$中的各备选方案$d_i$,与正理想解$C^*$和负理想解$C^0$的距离进行比较，既靠近正理想解又远离负理想解的方案就是方案集$D$中的最佳方案;并可以据此排定方案集$D$中各备选方案的优先序。

**这里正理想解可以假设越大越好**

##  算法和步骤

1. **用向量规划化的方法求得规范决策矩阵**

   设多属性决策问题的决策矩阵$A=(a_{ij})_{m \times n}$，规范化决策矩阵$B=(b_{ij})_{m \times n}$，其中
   $$
   b_{ij}=\frac{a_{ij}}{\sqrt{\sum\limits_{i=1}^{m}a_{ij}^2},i=1,2,\cdots,m,j=1,2,\cdots,n}
   $$
   
2. **构成加权规范阵**$C=(c_{ij})_{m\times n}$

   设有决策人给定各属性的权重向量为$\omega=[\omega_1,\omega_2,\cdots,\omega_n]^T$，则
   $$
   c_{ij}=\omega_j\cdot b_{ij},i=1,2,\cdots,m,j=1,2,\cdots,n
   $$

3. **确定正理想解**$C^*$**和负理想解**$C^0$

​	设正理想解$C^*$的第$j$个属性值为$c_j^*$，负理想解$C^0$第个$j$属性值为$c_j^0$，则
$$
正理想解\\
c_j^*=\begin{cases}
max\ c_{ij},\ j为效益性属性\\
min\ c_{ij},\ \ j为成本性属性\\
\end{cases}\\
负理想解\\
c_j^0=\begin{cases}
min\ c_{ij},\ j为效益性属性\\
max\ c_{ij},\ \ j为成本性属性\\
\end{cases}\\
$$

4. **计算各方案到正理想解与负理想解的距离**
   $$
   备选方案d_i到正理想解的距离为\\
   s_i^*=\sqrt{\sum\limits_{j=1}^{n}(c_{ij}-c_j^*)^2},i=1,2,\cdots,m\\
   备选方案d_i到负理想解的距离为\\
   s_i^0=\sqrt{\sum\limits_{j=1}^{n}(c_{ij}-c_j^0)^2},i=1,2,\cdots,m\\
   $$

5. **计算各方案的排队指标值(即综合评价指数)**
   $$
   f_i^*=\frac{s_i^0}{s_i^0+s_i^*},i=1,2,\cdots,m
   $$

6. **按**$f_i^*$**由大到小排列方案的优劣次序**

## 实例处理方法

### 数据预处理

数据的预处理又称属性值的规范化。

属性值具有多种类型,包括效益型、成本型和区间型等。这三种属性,效益型属性越大越好,成本型属性越小越好，区间型属性是在某个区间最佳。

在进行决策时，一般要进行属性值的规范化，主要有如下三个作用:

1. 属性值有多种类型，上述三种属性放在同一个表中不便于直接从数值大小判断方案的优劣,因此需要对数据进行预处理，使得表中任一属性下性能越优的方案变换后的属性值越大。

2. 非量纲化,多属性决策与评估的困难之一是属性间的不可公度性,即在属性值表中的每一列数具有不同的单位（量纲)。即使对同一属性,采用不同的计量单位，表中的数值也就不同。在用各种多属性决策方法进行分析评价时，需要排除量纲的选用对决策或评估结果的影响，这就是非量纲化。
3. 归一化,属性值表中不同指标的属性值的数值大小差别很大，为了直观，更为了便于采用各种多属
   与评估方法进行评价，需要把属性值表中的数值归一化,即把表中数值均变换到[0，1]区间上。

### 常用属性规范化方法有以下几种

1. 线性变换

   原始的决策矩阵为$A=(a_{ij})_{m\times n}$，变换后的决策矩阵记为$B=(b_{ij})_{m\times n}$。设$a_j^{max}$是决策矩阵第$j$列中的最大值，$a_j^{min}$是决策矩阵第$j$列中的最小值。若$x_j$为效益性属性，则
   $$
   b_{ij}=\frac{a_{ij}}{a_j^{max}}
   $$
   采用上式进行属性规范化时,经过变换的最差属性值不一定为0，最佳属性值为1。
   	若$x_j$为成本型属性，则
   $$
   b_{ij}=1-\frac{a_{ij}}{a_j^{max}}
   $$
   

   采用上式进行属性规范时，经过变换的最佳属性值不定为1，最差属性值为0。

2. 标准0一1变换
   为了使每个属性变换后的最优值为1且最差值为0，可以进行标准0-1变换。
   $$
   对效益型属性x_j，令\\
   b_{ij}=\frac{a_{ij}-a_j^{min}}{a_j^{max}-a_j^{min}}\\
   对成本型属性x_j，令\\
   b_{ij}=\frac{a_j^{max}-a_{ij}}{a_j^{max}-a_j^{min}}\\
   $$

3. 区间型属性的变换
   有些属性既非效益型又非成本型，如生师比。显然这种属性不能采用前面介绍的两种方法处理

::: echarts 最优属性值为区间时的数据处理

```js
option = {
    xAxis: {},
    yAxis: {},
    series: [{
        data: [[2, 0], [5, 1], [6, 1],[12, 0]],
        type: 'line'
    }]
};
```

:::
   $$
   设给定的最优属性区间为[a_j^0,a_j^*]，a_j^0为无法容忍下限，a_j^*为无法容忍上限，则\\
   b_{ij}=\begin{cases}
   1-(a_j^0-a_{ij})/(a_j^0-a_j')，若a_j'\leq a_{ij}\leq a_j^0\\
   1，若a_j^0\leq a_{ij}\leq a_j^*\\
   1-(a_{ij}-a_j^*)/(a_j''-a_j^*)，若a_j^*\leq a_{ij}\leq a_j''\\
   0，其他
   \end{cases}\\
   变换后的属性值b_{ij}与原属性值a_{ij}之间的函数图形为一般梯形。\\
   当属性值最优区间的上下限相等时,最优区间退化为一个点时，函数图形退化为三角形。
   $$

1. 向量规范化
   无论成本型属性还是效益型属性，向量规范化均用下式进行变换
   $$
   b_{ij}=\frac{a_{ij}}{\sqrt{\sum\limits_{i=1}^{m}a_{ij}^2}},i=1,\cdots,m,j=1,\cdots,n
   $$
   这种变换也是线性的，但是它与前面介绍的几种变换不同，从变换后属性的大小上无法分辨属性值的优劣。它的最大特点是，规范化后，各方案的同一属性值的平方和为1，因此常用于计算各方案与某种虚拟方案(如理想点或负理想点)的欧氏距离的场合。

2. 标准化处理
   在实际问题中，不同变量的测量单位往往是不一样的。为了消除变量的量纲效应，使每个变量都具有同等的表现力,数据分析中常对数据进行标准化处理,即
   $$
   b_{ij}=\frac{a_{ij}-\bar{a}_j}{s_j},i=1,2,\cdots,m,j=1,2,\cdots,n,\\
   其中\bar{a}_j=\frac{1}{m}\sum_{i=1}^ma_{ij},s_j=\sqrt{\frac{1}{m-1}\sum_{i=1}^m{(a_{ij}-\bar{x}_j)^2}},j=1,2,\cdots,n
   $$
   

## 总结

用理想解法求解多属性决策问题的概念简单，只要在属性空间定义适当的距离测度就能计算备选方案与理想解的距离。TOPSIS法所用的是欧氏距离。至于既用正理想解又用负理想解是因为在仅仅使用正理想解时有时会出现某两个备选方案与正理想解的距离相同的情况,为了区分这两个方案的优劣，引入负理想解并计算这两个方案与负理想解的距离，与正理想解的距离相同的方案离负理想解远者为优。

## 需要补充

代码和标准化，归一化，规范化的概念区分
