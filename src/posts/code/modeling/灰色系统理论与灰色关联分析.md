---
title: 灰色系统理论与灰色关联分析
date: 2024-03-03
icon: circle-info
---

灰色模型主要解决相关性和预测两大典型问题

模型选择:

1. 微分方程
2. 灰色预测
3. 差分方程
4. 马尔可夫预测
5. 时间序列
6. 插值拟合
7. 神经元网络

菜单

1. [灰色预测的概念](##灰色预测的概念)
2. [灰色生成数列](##灰色生成序列)
3. [灰色关联度分析](##灰色关联度分析)
4. [灰色模型GM](##灰色模型GM)
5. [灰色预测实例](##灰色预测实例)

灰色系统的应用范畴大致分为以下几方面:

1. 灰色关联分析。
2. 灰色预测:R人口预测;灾变预测...等等。
3. 灰色决策。
4. 灰色预测控制。

**灰色系统理论是人们认识客观系统改造客观系统的一个新型的理论工具。**

## 灰色预测的概念

### 灰色系统、白色系统和黑色系统

·白色系统是指一个系统的内部特征是完全己知的，即系统的信息是完全充分的。

黑色系统是指一个系统的内部信息对外界来说是一无所知的，只能通过它与外界的联系来加以观测研究。
灰色系统内的一部分信息是已知的，另一部分信息是未知的，系统内各因素间有不确定的关系。

### 灰色预测法

**灰色预测法是一种对含有不确定因素的系统进行预测的方法。**

灰色预测是对既含有已知信息又含有不确定信息的系统进行预则，就是对在一定范围内变化的、与时间有关的灰色过程进行预测。

灰色预测通过鉴别系统因素之间发展趋势的相异程度，即进行关联分析，并可对原始数据进行生成处理来寻找系统变动的规律，生成有较强规律性的数据序列,然后建立相应的微分方程模型，从而预测事物未来发展趋势的状况。

灰色预测法用等时距观测到的反映预测对象特征的一系列数量值构造灰色预测模型，预测未来某一时刻的特征量，或达到某一特征量的时间。

### 灰色预测的四种常见类型

#### 灰色时间序列预测

即用观察到的反映预测对象特征的时间序列来构造灰色预测模型，预测未来某一时刻的特征量，或达到某一特征量的时间。

#### 畸变预测

即通过灰色模型预测异常值出现的时刻，预测异常值什么时候出现在特定时区内。

#### 系统预测

通过对系统行为特征指标建立一组相互关联的灰色预测模型，预测系统中众多变量间的相互协调关系的变化。

#### 拓扑预测

将原始数据做曲线，在曲线上按定值寻找该定值发生的所有时点，并以该定值为框架构成时点数列，然后建立模型预测该定值所发生的时点。

## 灰色关联度分析

### 灰色关联度

选取参考数列
$$
X_0=\{X_0(k)\vert k=1,2,\cdots,n\}=(X_0(1),X_0(2),\cdots,X_0(n))
$$
其中$k$表示时刻

假设有$m$个比较数列
$$
X_i=\{X_i(k)\vert k=1,2,\cdots,n\}=(X_i(1),X_i(2),\cdots,X_i(n))\\
(i=1,2,\cdots,m)
$$
则称
$$
\xi_i(k)=\frac{\underset{i}{min}\ \underset{k}{min}\vert X_0(k)-X_i(k)\vert+\rho \ \underset{i}{max}\ \underset{k}{max}\vert X_0(k)-X_i(k)\vert}{\vert X_0(k)-X_i(k)\vert+\rho \ \underset{i}{max}\ \underset{k}{max}\vert X_0(k)-X_i(k)\vert}
$$
为比较数列$X$对参考数列$X_0$在$k$时刻的**关联系数**，其中$\rho\in[0,+\infty]$ 为分辨系数。一般来讲，分辨系数$\rho\in[0,1]$ ，容易看出，$\rho$越大，分辩率越大；$\rho$越小，分辩率越小。

公式定义的关联系数是描述比较数列与参考数列在某时刻关联程度的一种指标,由于各个时刻都有一个关联系数，因此信息显得过于分散，不便于比较，为此我们给出
$$
r_i=\frac{1}{n}\sum_{k=1}^n\xi_i(k)
$$
为比较数列$X_i$对参考数列$X_0$的**关联度**。

应该指出的是，公式中的$\vert X_0(k)-X_i(k)\vert$不能区别因素关联的是正关联还是负关联，可采取下面办法解决这个问题,记
$$
\sigma_i=\sum_{k=1}^nkX_i(k)-\sum_{k=1}^nX_i(k)\sum_{k=1}^n\frac{k}{n}\\
\sigma_n=\sum_{k=1}^nk^2-(\sum_{k=1}^nk)\frac{2}{n}\\
当sign(\frac{\sigma_i}{\sigma_n})=sign(\frac{\sigma_j}{\sigma_n})，则X_i和X_j为正关联\\
当sign(\frac{\sigma_i}{\sigma_n})=-sign(\frac{\sigma_j}{\sigma_n})，则X_i和X_j为负关联\\
$$

### 案例分析

利用灰色关联分析对6位教师工作状况进行综合分析

1. 分析指标包括:专业素质、外语水平、教学工作量、科研成果、论文、著作与出勤.
2. 对原始数据经处理后得到以下数值，见下表

| 编号 | 专业 | 外语 | 教学量 | 科研 | 论文 | 著作 | 出勤 |
| :--: | :--: | :--: | :----: | :--: | :--: | :--: | :--: |
|  1   |  8   |  9   |   8    |  7   |  5   |  2   |  9   |
|  2   |  7   |  8   |   7    |  5   |  7   |  3   |  8   |
|  3   |  9   |  7   |   9    |  6   |  6   |  4   |  7   |
|  4   |  6   |  8   |   8    |  8   |  4   |  3   |  6   |
|  5   |  8   |  6   |   6    |  9   |  8   |  3   |  8   |
|  6   |  8   |  9   |   5    |  7   |  6   |  4   |  8   |

3. 确定参考数据列
   $$
   \{x_0\}=\{9,9,9,9,8,9,9\}
   $$
   
4. 计算$\vert x_0(k)-x_j(k)\vert$，见下表

| 编号 | 专业 | 外语 | 教学量 | 科研 | 论文 | 著作 | 出勤 |
| :--: | :--: | :--: | :----: | :--: | :--: | :--: | :--: |
|  1   |  1   |  0   |   1    |  2   |  3   |  7   |  0   |
|  2   |  2   |  1   |   2    |  4   |  1   |  6   |  1   |
|  3   |  0   |  2   |   0    |  3   |  2   |  5   |  2   |
|  4   |  3   |  1   |   1    |  1   |  4   |  6   |  3   |
|  5   |  1   |  3   |   3    |  0   |  0   |  6   |  1   |
|  6   |  1   |  0   |   4    |  2   |  2   |  5   |  1   |

5. 求最值

$$
\mathop{min} \limits_{i=1}^n \ \mathop{min} \limits_{k=1}^m \vert x_0(k)-x_i(k)\vert=min(0,1,0,1,0,0)=0\\
\mathop{max} \limits_{i=1}^n \ \mathop{max} \limits_{k=1}^m \vert x_0(k)-x_i(k)\vert=max(7,6,5,6,6,5)=7\\
$$

6. 取$\rho$为$0.5$得到

$$
\xi_1(1)=\frac{0+0.5\times7}{1+0.5\times7}=0.778,\cdots,\xi_1(7)=1.000
$$

7. 每个人求平均值找关联度

## 灰色生成序列

 灰色系统理论认为，尽管客观表象复杂，但总是有整体功能的，因此必然蕴含某种内在规律。关键在于如何选择适当的方式去挖掘和利用它。灰色系统是通过对原始数据的整理来寻求其变化规律的，这是一种就数据寻求数据的现实规律的途径，即为灰色序列的生成。一切灰色序列都能通过某种生成弱化其随机性，显现其规律性。数据生成的常用方式有累加生成、累减生成和加权累加生成。

1. 累加生成
   把数列各项（时刻）数据依次累加的过程称为累加生成过程由累加生成过程所得的数列称为累加生成数列
   $$
   设原始数列为x^{(0)}=(x^{(0)}(1),x^{(0)}(2),\cdots,x^{(0)}(n))\\
   x^{(1)}(k)=\sum_{i=1}^kx^{(0)}(i),k=1,2,\cdots,n\\
   令\
   x^{(1)}=(x^{(1)}(1),x^{(1)}(2),\cdots,x^{(1)}(n))\\
   称所得到的新数列为数列x^{(0)}的1次累加生成数列。\\
   类似的有\
   x^{(r)}(k)=\sum_{i=1}^kx^{(r-1)}(i),k=1,2,\cdots,n,r\geq1\\
   称为x^{(0)}的r次累加生成数列
   $$

2. 称所得到的新数列为数列x °的1次累加生成数列。类似地有
   称为x°的r次累加生成数列。

2. 累减生成
   对于原始数据列依次做前后相邻的两个数据相减的运算过程称为累减生成过程IAGO。
   $$
   如果原始数据列为x^{(1)}=(x^{(1)}(1),x^{(1)}(2),\cdots,x^{(1)}(n))\\
   令x^{(0)}(k)=x^{(1)}(k)-x^{(1)}(k-1),k = 2,3,\cdots,n称所得到的数列x^{(0)}为x^{(1)}的1次累减生成数列。
   $$
   注：从这里的记号也可以看到，从原始数列$x^{(0)}$，得到新数列$x^{(1)}$，再通过累减生成可以还原出原始数列。实际运用中在数列$x^{(1)}$的基础上预测出$\widehat{x}^{(1)}$，通过累减生成得到预测数列$\widehat{x}^{(0)}$。

3. 加权邻值生成
   设原始数列为$x^{(0)}=(x^{(0)}(1),x^{(0)}(2),\cdots,x^{(0)}(n))$称$x^{(0)}(k-1),x^{(0)}(k)$为数列$x^{(0)}$的任意一对邻值。

   $x^{(0)}(k-1)$为后邻值，$x^{(0)}(k)$为前邻值，

   对于常数$\alpha\in[0,1]$令$z^{(0)}(k)=\alpha x^{(0)}(k)+(1-\alpha)x^{(0)}(k-1),k=2,3,\cdots,n$有此得到的数列$z^{(0)}$称为数列$x^{(0)}$在权$\alpha$下的邻值生成数，权$\alpha$也称为生成系数。

   特别的，当生成系数$\alpha=0.5$时，则称$z^{(0)}(k)=0.5x^{(0)}(k)+0.5x^{(0)}(k-1),k=2,3,\cdots,n$为均值生成数，也称等权邻值生成数

## 灰色模型GM

灰色系统理论是基于关联空间、光滑离散函数等概念定义灰导数与灰微分方程,进而用离散数据列建立微分方程形式的动态模型，即灰色模型是利用离散随机数经过生成变为随机性被显著削弱而且较有规律的生成数，建立起的微分方程形式的模型，这样便于对其变化过程进行研究和描述。

G表示grey（灰色），M表示model（模型）

设$x^{(0)}=(x^{(0)}(1),x^{(0)}(2),\cdots,x^{(0)}(n))$为原始数列，其1次累加生成数列为$x^{(1)}=(x^{(1)}(1),x^{(1)}(2),\cdots,x^{(1)}(n))$其中$x^{(1)}(k)=\sum\limits_{i=1}^kx^{(0)}(i),k=1,2,\cdots,n$

定义$x^{(1)}$的灰导数为$d(k)=x^{(0)}(k)=x^{(1)}(k)-x^{(1)}(k-1)$

令$z^{(1)}(k)$为数列$x^{(1)}$的邻值生成数列，即$z^{(1)}(k)=\alpha x^{(1)}(k)+(1-\alpha)x^{(1)}(k-1)$

于是定义GM（1，1）的灰微分方程模型为$d(k)+az^{(1)}(k)=b$其中$x^{(0)}(k)$称为灰导数，$a$称为发展系数，$z^{(1)}(k)$称为白化背景值，$b$称为灰作用量

将时刻表$k=2,3,\cdots,n$代入有
$$
\begin{cases}
x^{(0)}(2)+az^{(1)}(2)=b,\\
x^{(0)}(3)+az^{(1)}(3)=b,\\
\quad\quad\quad\cdots\cdots\cdots\\
x^{(0)}(n)+az^{(1)}(n)=b,\\
\end{cases}
$$
引入矩阵向量记号
$$
u=
\left[
\begin{matrix}
a\\b
\end{matrix}
\right]\quad
Y=\left[
\begin{matrix}
x^{(0)}(2)\\
x^{(0)}(3)\\
\vdots\\
x^{(0)}(n)
\end{matrix}
\right]\quad
B=\left[
\begin{matrix}
-z^{(1)}(2) &1\\
-z^{(1)}(3) &1\\
\vdots &\vdots\\
-z^{(1)}(n) &1\\
\end{matrix}
\right]\\
$$
于是GM（1，1）模型可表示为$Y=Bu$

现在问题归结为求$a,b$在值。用一元线性回归，即最小二乘法求他们的估计值为
$$
\widehat{u}=
\left[
\begin{matrix}
\widehat{a}\\
\widehat{b}
\end{matrix}
\right]=(B^TB)^{-1}B^TY
$$
注:实际上回归分析中求估计值是用软件计算的，有标准程序求解，如matlab等。

**GM (1，1)的白化型**

对于 GM （1，1）的灰微分方程，如果将灰导数$x^{(0)}(k)$的时刻$k=2,3,\cdots,n$视为连续变量$t$，则$x^{(1)}$视为时间$t$函数$x^{(1)}(t)$，于是$x^{(0)}(k)$对应于导数量级$\frac{dx^{(1)}(t)}{dt}$，白化背景值$z^{(1)}(k)$对应于导数$x^{(1)}(t)$。于是GM (1，1)的灰微分方程对应于的白微分方程为
$$
\frac{dx^{(1)}(t)}{dt}+ax^{(1)}(t)=b
$$
证明过程
$$
\int_{k-1}^k\frac{dx^1}{dt}dt+\int_{k-1}^kax^1dt=\int_{k-1}^kbdt\\
\int_{k-1}^kax^1dt\approx\frac{a}{2}(x^1{k}+x^1(k-1))=az^1\\
白化方程化为x^0+az^1=b
$$

### GM(1，1)灰色预测的步骤

1. 数据的检验与处理

   为了保证GM （1，1）建模方法的可行性，需要对已知数据做必要的检验处理。
   设原始数据列为$x^{(0)}=(x^{(0)}(1),x^{(0)}(2),\cdots,x^{(0)}(n))$，计算数列的**级比**
   $$
   \lambda(k)=\frac{x^{(0)}(k-1)}{x^{(0)}(k)},k=2,3,\cdots,n
   $$
   如果所有的级比都落在可容覆盖区间$X = ( e^{\frac{-2}{n+1}} , e^{\frac{2}{n+1}}  )$内，则数据列$x^{(0)}$可以建立GM （1，1）模型且可以进行灰色预测。

   否则对数据做适当的变换处理，如平移变换:
   $$
   取C使得数据列\quad
   y^{(0)}(k)=x^{(0)}(k)+c,k=1,2,\cdots,n\\
   的级比都落在可容覆盖内。
   $$
   
2. 建立GM (1，1)模型
   不妨设$x^{(0)}=(x^{(0)}(1),x^{(0)}(2),\cdots,x^{(0)}(n))$​满足上面的要求，以它为数据列建立GM (1，1)模型
   $$
   x^{(0)}(k)+az^{(1)}(k)=b
   $$
   用回归分析求得$a,b$的估计值，于是相应的白化模型为
   $$
   \frac{dx^{(1)}(t)}{dt}+ax^{(1)}(t)=b
   $$
   解为
   $$
   x^{(1)}(t)=(x^{(0)}(1)-\frac{b}{a})e^{-a(t-1)}+\frac{b}{a}
   $$
   于是得到预测值
   $$
   \widehat{x}^{(1)}(k+1)=(x^{(0)}(1)-\frac{b}{a})e^{-ak}+\frac{b}{a},k=1,2,\cdots,n-1
   $$
   而相应地得到预测值
   $$
   \widehat{x}^{(0)}(k+1)=\widehat{x}^{(1)}(k+1)-\widehat{x}^{(1)}(k),k=1,2,\cdots,n-1
   $$

3. 检验预测值

   - 残差检验:计算相对残差
     $$
     \epsilon(k)=\frac{x^{(0)}(k)-\widehat{x}^{(0)}(k)}{x^{(0)}(k)},k=1,2,\cdots,n
     $$
     如果对所有的$\vert\epsilon(k)\vert<0.1$，则认为达到较高的要求：否则，若对所有的$\vert\epsilon(k)\vert<0.2$，则认为达到一般要求。

   - 级比偏差值检验：计算
     $$
     \rho(k)=1-\frac{1-0.5a}{1+0.5a}\lambda(k)
     $$
     

     如果对所有的$\vert\rho(k)\vert<0.1$，则认为达到较高的要求

     ​    若对所有的$\vert\rho(k)\vert<0.2$，则认为达到一般要求。

## 灰色预测实例

北方某城市1986～1992年道路交通噪声平均声级数据见表
| 序号 | 年份 | eq L |
| :--: | :--: | :--: |
|  1   | 1986 | 71.1 |
|  2   | 1987 | 72.4 |
|  3   | 1988 | 72.4 |
|  4   | 1989 | 72.1 |
|  5   | 1990 | 71.4 |
|  6   | 1991 | 72.0 |
|  7   | 1992 | 71.6 |

1. 级比检验

   建立交通噪声平均声级数据时间序列如下：
   $$
   x^{(0)}=(x^{(0)}(1),x^{(0)}(2),\cdots,x^{(0)}(7))\\
   =(71.1,72.4,72.4,72.1,71.4,72.0,71.6)\\
   \lambda(k)=\frac{x^{(0)}(k-1)}{x^{(0)}(k)},\lambda        =(0.982,1,1.0042,1.0098,0.9917,1.0056)满足
   $$

2. GM（1，1）建模

   对原始数据$x^{(0)}$做一次累加，即
   $$
   x^{(1)}=(71.1,143.5,215.9,288,359.4,431.4,503)
   $$
   构造数据矩阵$B$及数据向量$Y$
   $$
   B=\left[
   \begin{matrix}
   -\frac{1}{2}(x^{(1)}(1)+x^{(1)}(2)) &1\\
   -\frac{1}{2}(x^{(1)}(2)+x^{(1)}(3)) &1\\
   \vdots &\vdots\\
   -\frac{1}{2}(x^{(1)}(6)+x^{(1)}(7)) &1\\
   \end{matrix}
   \right],Y=\left[
   \begin{matrix}
   x^{(0)}(2)\\
   x^{(0)}(3)\\
   \vdots \\
   x^{(0)}(7)\\
   \end{matrix}
   \right]
   $$
   计算$\widehat{u}$
   $$
   \widehat{u}=(\widehat{a},\widehat{b})^T=(B^TB)^{-1}B^TY=\left[
   \begin{matrix}
   0.0023\\
   72.6573
   \end{matrix}
   \right]
   $$
   于是得到$a=0.0023,b=72.6573$​

   建立模型
   $$
   \frac{dx^{(1)}(t)}{dt}+0.0023x^{(1)}(t)=72.6573
   $$
   求解得
   $$
   \widehat{x}^{(1)}(k+1)=(x^{(0)}(1)-\frac{b}{a})e^{-ak}+\frac{b}{a}=-30929e^{-0.0023k}+31000
   $$
   求生成数列值$\widehat{x}^{(1)}(k+1)$及模型还原值$\widehat{x}^{(0)}(k+1)$
   $$
   \widehat{x}^{(1)}(1)=\widehat{x}^{(0)}(1)=x^{(0)}(1)=71.1,令k=1,2,3,4,5,6
   $$
   令由上面的时间相应函数可算得$\widehat{x}^{(1)}$
   $$
   由\widehat{x}^{(0)}(k)=\widehat{x}^{(1)}(k)-\widehat{x}^{(1)}(k-1)\\
   取k=2,3,4,\cdots,7得\\
   \widehat{x}^{(0)}=(71.1,72.4,72.2,72.1,71.9,71.7,71.6)
   $$

3. 模型检验

   如下表

   | 序号 | 年份 | 原始值 | 模型值 |  残差   | 相对误差 | 级比误差 |
   | :--: | :--: | :----: | :----: | :-----: | :------: | :------: |
   |  1   | 1986 |  71.1  |  71.1  |    0    |    0     |          |
   |  2   | 1987 |  72.4  |  72.4  | -0.0057 |  0.01%   |  0.0023  |
   |  3   | 1988 |  72.4  |  72.2  | 0.1638  |  0.23%   |  0.0203  |
   |  4   | 1989 |  72.1  |  72.1  | 0.0329  |  0.05%   | -0.0018  |
   |  5   | 1990 |  71.4  |  71.9  | -0.4984 |   0.7%   | -0.0074  |
   |  6   | 1991 |  72.0  |  71.7  | 0.2699  |  0.37%   |  0.0107  |
   |  7   | 1992 |  71.6  |  71.6  | 0.0378  |  0.05%   | -0.0032  |

   经验证，该模型的精度较高，可进行预测和预报
