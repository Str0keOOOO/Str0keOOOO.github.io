---
title: 矩阵乘法
date: 2024-08-05
icon: circle-info
order: 1
---

# 矩阵乘法——点乘和矩阵乘

## 点乘（即“ * ”）——各个矩阵对应元素做乘法

若 x 为**m*1**的矩阵，y 为**m*1**的矩阵，那么通过点乘结果就会得到一个**m*n** 的矩阵。
$$
res=xy=\begin{pmatrix}
w_{11}  \\
w_{21}
\end{pmatrix}
\begin{pmatrix}
x_{11} & x_{12} & x_{13} \\
x_{21} & x_{22} & x_{23}
\end{pmatrix}
=\begin{pmatrix}
w_{11}x_{11} & w_{11}x_{12} & w_{11}x_{13} \\
w_{21}x_{21} & w_{21}x_{22} & w_{21}x_{23}
\end{pmatrix}
$$
若 x 为**m*n** 的矩阵，y 为 **m*n** 的矩阵，那么通过点乘结果就会得到一个**m*n**的矩阵。
$$
res=xy=\begin{pmatrix}
w_{11} & w_{12} & w_{13} \\
w_{21} & w_{22} & w_{23}
\end{pmatrix}
\begin{pmatrix}
x_{11} & x_{12} & x_{13} \\
x_{21} & x_{22} & x_{23}
\end{pmatrix}
=\begin{pmatrix}
w_{11}x_{11} & w_{12}x_{12} & w_{13}x_{13} \\
w_{21}x_{21} & w_{22}x_{22} & w_{23}x_{23}
\end{pmatrix}
$$
**x的列数**只能为 **1** 或**与y的列数相等**，**x的行数与y的行数相等**才能进行乘法运算。

```python
x = np.array([[1, 2, 3], [4, 5, 6]])
y = np.array([[1, 2, 3], [4, 5, 6]])
print(x * y)  # 点乘
# 输出：[[ 1  4  9]
#       [16 25 36]]
```

## 矩阵乘 —— 按照矩阵乘法规则做运算

若 x 为 **m\*p** 的矩阵，y 为 **p\*n** 的矩阵，那么通过矩阵相乘结果就会得到一个**m\*n** 的矩阵。

只有 **x 的列数 == y的行数** 时，才能进行乘法运算

$$
res=xy=\begin{pmatrix}
w_{11} & w_{12} \\
w_{21} & w_{22} \\
w_{31} & w_{32}
\end{pmatrix}
\begin{pmatrix}
x_{11} & x_{12} & x_{13} \\
x_{21} & x_{22} & x_{23}
\end{pmatrix}
=\begin{pmatrix}
w_{11}x_{11}+w_{12}x_{11} & w_{11}x_{12}+w_{12}x_{22} & w_{11}x_{13}+w_{12}x_{23} \\
w_{21}x_{11}+w_{22}x_{21} & w_{21}x_{12}+w_{22}x_{22} & w_{21}x_{13}+w_{22}x_{23} \\
w_{31}x_{11}+w_{32}x_{21} & w_{31}x_{12}+w_{32}x_{22} & w_{31}x_{13}+w_{32}x_{23}
\end{pmatrix}
$$

```python
x = np.array([1, 2])
y = np.array([[1], [2]])
print(np.dot(x, y))  # 矩阵乘
# 输出：[5]
```
